# GeoJSON 기반 지역 검색 정확도 개선

## 개요

사용자의 현재 위치를 기준으로 정확한 거리 기반 공고 추천을 구현하고, 개선 전후 주요 지표를 모니터링하여 추천 품질을 향상시킨 프로젝트입니다.

## 문제상황

기존에는 검색 서비스에서 GeoJSON 기반 공간 쿼리를 지원하지 않아, MongoDB에서 행정구역코드 `regionId` 기반으로 공고를 필터링한 뒤, 좌표 기반 600m 반경 내 포함 여부를 별도로 판단하는 구조였습니다. 그러나 행정구역 단위인 `regionId`와 실제 거리 반경은 일치하지 않아, 위치상 가까운 게시글이 누락되는 문제가 있었습니다. 그 결과, 항상 실제 반경 내 게시글 수보다 적은 수의 결과만 노출되었습니다.

## 개선목표

- 사용자 좌표 기준 반경 내 공고를 정확히 필터링하여 추천 품질 향상
- 잘못된 필터링 로직으로 누락되던 공고 포함
- 개선 전후 클릭률/지원률 등 사용자 반응 지표 정량적 측정

## 해결전략

1. 검색 서비스에서 GeoJSON 기반 공간 쿼리가 추가되어, 기존 MongoDB 기반 좌표 필터링 로직을 제거하고 검색 단계에서 반경 내 공고 필터링을 직접 수행하도록 구조 개선

2. 사용자 중심 좌표와 반경(600m)을 기반으로 GeoJSON `Polygon` 객체 생성

   [circle-to-polygon](https://www.npmjs.com/package/circle-to-polygon) 라이브러리 도입 배경
   GeoJSON은 원형(`Circle`) 영역을 직접 지원하지 않기 때문에, 반경 기반 검색을 구현하려면 원을 근사한 다각형(`Polygon`)이 필요합니다. 직접 위경도 기반 좌표 계산을 구현하는 방식은 정확도 관리와 유지보수 측면에서 비효율적이라 판단하였고, 다음과 같은 이유로 `circle-to-polygon` 라이브러리를 도입하였습니다:

   - 중심 좌표와 반경(m)을 입력하면 GeoJSON `Polygon` 객체 생성
   - 정밀도 조절(`numberOfEdges`) 및 지구 반지름 보정(`earthRadius`) 기능을 제공
   - 생성된 Polygon은 내부 검색 서비스의 GeoJSON 쿼리 조건에 바로 활용 가능

3. 2주동안 BigQuery에 사용자 로그를 적재하고, Superset으로 개선 전후 지표를 시각화하여 정량적 성과를 분석

## 성과

- 평균 노출 공고 수가 기존 5개 미만에서 10개 수준으로 증가
- Superset 기반 대시보드를 구축하여 지표 모니터링을 수행한 결과 다음과 같은 개선 확인
  - 클릭률(CTR): +19%
  - 지원률(CVR): +65%
  - 노출 수: +7%

## 사용기술 및 도구

- 검색 플랫폼 (GeoJSON 공간 쿼리 지원)
- Node.js, circle-to-polygon
- BigQuery, Superset

## 개인 기여

- circle-to-polygon 라이브러리 도입
- GeoJSON 기반 공간 쿼리 도입 및 검증 로직 구현
- BigQuery 기반 지표 집계 및 Superset 대시보드 시각화 구성
- 실험 설계 및 정량적 성과 측정

## 회고

거리 기반 추천의 정확도를 높이기 위해 단순 좌표 필터링을 넘어 공간 지오메트리 단위로 설계하는 경험을 할 수 있었습니다. 특히 사용자 반응 지표를 기반으로 개선 효과를 수치로 검증하며, 실험 중심의 기능 개발 역량을 키울 수 있었습니다. 앞으로도 기술적 구현뿐 아니라 측정 가능한 성과 중심의 개발을 지향하고자 합니다.
